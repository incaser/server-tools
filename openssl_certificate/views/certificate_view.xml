<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

	<!-- Certificate Search View  -->
	<record id="view_openssl_certificate_search" model="ir.ui.view">
		<field name="name">OpenSSL Certificate Search</field>
		<field name="model">openssl.certificate</field>
		<field name="arch" type="xml">
			<search string="Search Certificates">
				<field name="name" string="Certificate" filter_domain="[('name','ilike',self)]"/>
				<field name="partner_id" string="Partner"/>
				<!--<separator/>-->
				<!--<field name="date" string="Date Greather than"-->
					   <!--filter_domain="[('date','&gt;=',self)]"/>-->
				<!--<field name="date" string="Date Less than"-->
					   <!--filter_domain="[('date','&lt;=',self)]"/>-->
				<separator/>
				<filter domain="[('state','=','draft')]" help="Draft"/>
				<filter domain="[('state','=','waiting')]" help="Waiting"/>
				<filter domain="[('state','=','confirmed" help="Confirmed"/>
				<filter domain="[('state','=','cancel')]" help="Cancel"/>
				<!--<separator/>-->
				<!--<filter domain="[('status_email','=','to_send')]" help="To Send"/>-->
				<!--<filter domain="[('status_email','=','send')]" help="Send"/>-->

			</search>
		</field>
	</record>

	<record id="view_openssl_certificate_tree" model="ir.ui.view">
		<field name="name">openssl.certificate.tree</field>
		<field name="model">openssl.certificate</field>
		<field name="type">tree</field>
		<field name="arch" type="xml">
			<tree string="Certificates">
				<field name="partner_id"/>
				<field name="name"/>
				<field name="status_email"/>
				<field name="state"/>
			</tree>
		</field>
	</record>

	<record id="view_openssl_certificate_form" model="ir.ui.view">
		<field name="name">openssl.certificate.form</field>
		<field name="model">openssl.certificate</field>
		<field name="type">form</field>
		<field name="arch" type="xml">
			<form string="Certificate">
			<header>
				<button name="create_ca_cert" type="object" string="Crear CA"/>
				<button name="generate_certificate" type="object" string="Generate Certificate"/>
				<button name="send_email" type="object" string="Send By Email"/>
				<field name="state" widget="statusbar" statusbar_colors='{}'/>
			</header>
			<sheet>
				<group>
					<group>
						<field name="name"/>
						<field name="type"/>
						<field name="partner_id"/>
					</group>
					<group>
						<field name="keypair_id"/>
						<field name="status_email"/>
					</group>
				</group>
				<separator string="Certificate"/>
				<field name="crt"/>
				<separator string="Export data PKCS12"/>
				<field name="password"/>
			</sheet>
			</form>
		</field>
	</record>

	<record id="action_openssl_certificate" model="ir.actions.act_window">
            <field name="name">Certificates</field>
            <field name="res_model">openssl.certificate</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_openssl_certificate_tree"/>
	</record>

    <!-- SEND EMAILS FROM CERTIFICATE -->
    <record id="openssl_certificate_send_email" model="ir.actions.server">
        <field name="sequence" eval="5"/>
        <field name="state">code</field>
        <field name="type">ir.actions.server</field>
        <field name="model_id" ref="openssl_certificate.model_openssl_certificate"/>
        <field name="code">action=self.send_email(cr, uid, context['active_ids'],context)
        </field>
        <field name="condition">True</field>
        <field name="name">Send Email</field>
    </record>

    <record id="binding_openssl_certificate_send_email" model="ir.values">
      <field name="name">Send Email</field>
      <field name="key2">client_action_multi</field>
      <field name="value" eval="'ir.actions.server,' +str(ref('openssl_certificate_send_email'))" />
      <field name="model">openssl.certificate</field>
    </record>

    </data>
</openerp>
